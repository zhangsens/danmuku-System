!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.cDraw=n():t.cDraw=n()}(this,function(){return function(t){function n(a){if(i[a])return i[a].exports;var e=i[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,n),e.l=!0,e.exports}var i={};return n.m=t,n.c=i,n.d=function(t,i,a){n.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:a})},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=0)}([function(t,n,i){"use strict";function a(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var e=function(){function t(t,n){for(var i=0;i<n.length;i++){var a=n[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(n,i,a){return i&&t(n.prototype,i),a&&t(n,a),n}}(),o=i(1),s=i(2),r=0;setInterval(function(){r=0},2e3);var u=function(){function t(n){a(this,t),this.danmaku_store=new Array,this.danmaku_sort=new Array,this.danmaku_video=new Array,this.danmaku_speed=2,this.danmaku_played=!0,this.canvas=n.ele||o,this.ctx=this.canvas.getContext("2d"),this.gradient=this.ctx.createLinearGradient(0,0,this.canvas.width,0),this.position_x=this.canvas.width,this.media=n.media,this.add_danmaku(n.danmaku),this.ctx.font=s.weight+" "+s.size+"px "+s.family,requestAnimationFrame(this.danmaku_animation.bind(this)),requestAnimationFrame(this.danmaku_video_add_animation.bind(this))}return e(t,[{key:"add_danmaku",value:function(t){this.danmaku_store=this.danmaku_store.concat(t),this.danmaku_sort_reset()}},{key:"danmaku_animation",value:function(){this.ctx.clearRect(0,0,1200,800);for(var t=0;t<this.danmaku_video.length;t++)this.gradient.addColorStop("0","white"),this.ctx.fillStyle=this.gradient,this.ctx.fillText(this.danmaku_video[t].content,this.danmaku_video[t].position_x,this.danmaku_video[t].position_y),this.danmaku_video[t].position_x+=-this.danmaku_speed,this.danmaku_video[t].position_x<-this.danmaku_video[t].content.length*s.size&&(this.danmaku_video.splice(t,1),t--);this.danmaku_played&&requestAnimationFrame(this.danmaku_animation.bind(this))}},{key:"danmaku_video_add_animation",value:function(){for(var t=0;t<this.danmaku_sort.length;t++)this.danmaku_sort.length>0&&this.danmaku_sort[0].time<this.media.currentTime&&(this.danmaku_sort[0].position_x=this.position_x,this.danmaku_sort[0].position_y=(r+1)*s.size,this.danmaku_video.push({content:this.danmaku_sort[0].content,position_x:this.danmaku_sort[0].position_x,position_y:this.danmaku_sort[0].position_y}),this.danmaku_sort.splice(0,1),r++,t--);this.danmaku_played&&requestAnimationFrame(this.danmaku_video_add_animation.bind(this))}},{key:"danmaku_sort_reset",value:function(){this.danmaku_sort=[].concat(this.danmaku_store),this.danmaku_sort.sort(function(t,n){return t.time-n.time});for(var t=0;t<this.danmaku_sort.length;t++)this.danmaku_sort[0].time<this.media.currentTime&&(this.danmaku_sort.splice(0,1),t--)}}]),t}();t.exports=u},function(t,n,i){"use strict";var a=document.createElement("canvas");t.exports=a},function(t,n,i){"use strict";var a={style:"normal",variant:"normal",weight:"900",family:"SimHei",size:"24"};t.exports=a}])});